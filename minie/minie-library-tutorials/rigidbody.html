<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>An introduction to rigid-body physics :: The Minie project</title>
    <link rel="canonical" href="https://stephengold.github.io/Minie/minie/minie-library-tutorials/rigidbody.html">
    <meta name="generator" content="Antora 2.3.3">
    <link rel="stylesheet" href="../../_/css/site.css">
<meta property="og:image" content="../../_/img/iconx128.png">
<meta property="og:description" content="An introduction to rigid-body physics">
<meta property="og:title" content="The Minie project">
<link rel="icon" href="../../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://stephengold.github.io/Minie">
        <img alt="" src="../../_/img/iconx128.png" width="32" type="image/x-icon" style="margin-right:16px">
        The Minie project
        </a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item theme-switch-wrapper">
          <label class="theme-switch" for="checkbox">
            <input type="checkbox" id="checkbox" />
            <div class="slider round"></div>
          </label>
          <p class="navlabel">Dark Mode</em>
        </div>
        <a class="navbar-item" href="https://github.com/stephengold/Minie">Repository</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="minie" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../overview.html">The Minie project</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://hub.jmonkeyengine.org/c/user-code-projects/minie/63">Forum</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://github.com/stephengold/Minie">Git repository</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://raw.githubusercontent.com/stephengold/Minie/master/LICENSE">License</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://github.com/stephengold/Minie/releases/latest">Latest release</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://github.com/stephengold/Minie/blob/master/MinieLibrary/release-notes.md">Release log</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Library tutorials:</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="add.html">Add to existing project</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="rigidbody.html">Rigid bodies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="shape.html">Collision shapes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="debug.html">Debugging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="new6dof.html">New6Dof joints</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dac.html">Ragdolls</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="detect.html">Collision detection</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="softbody.html">Soft bodies</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://stephengold.github.io/Minie/minie/javadoc">Library API</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://bintray.com/stephengold/com.github.stephengold/Minie">Bintray page</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://jitpack.io/#stephengold/Minie">JitPack page</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://jmonkeystore.com/38308161-c3cf-4e23-8754-528ca8387c11">JmonkeyStore page</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://github.com/stephengold/Minie/issues">Issue tracker</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Related projects:</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://jmonkeyengine.org">JMonkeyEngine</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/stephengold/Libbulletjme">Libbulletjme</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://pybullet.org/wordpress">Bullet</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/kmammou/v-hacd">V-HACD</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/stephengold/Heart">Heart</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://jmonkeystore.com/4477514f-a3ae-4d42-b928-d3a62335159f">Advanced vehicles</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://jmonkeystore.com/1a85df6f-4bb6-4c85-9e77-b5119662ed54">Blocks</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">The Minie project</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">The Minie project</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../overview.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../overview.html">The Minie project</a></li>
    <li>Library tutorials:</li>
    <li><a href="rigidbody.html">Rigid bodies</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/stephengold/Minie/edit/master/MinieLibrary/src/site/antora/tutorials/modules/minie-library-tutorials/pages/rigidbody.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">An introduction to rigid-body physics</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>A rigid body (instance of <code>PhysicsRigidBody</code>) is a type of collision object
that exhibits some familiar features of real-world objects, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>rigidity (a fixed shape) and</p>
</li>
<li>
<p>inertia (resistance to changes in its motion).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When creating a rigid body directly, one can specify both its mass
and collision shape. Together, these properties determine its inertia:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">CollisionShape ballShape = new SphereCollisionShape(1f);
float ballMass = 2f;
PhysicsRigidBody ball = new PhysicsRigidBody(ballShape, ballMass);
Vector3f inertia = Vector3f.UNIT_XYZ.divide(ball.getInverseInertiaLocal(null));</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, rigid bodies also exhibit 3 more features of real-world objects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>They are dynamic
(mobile, with motion determined by forces, torques, and impulses.)</p>
</li>
<li>
<p>They are subject to gravity:
a continual downward force proportional to their mass.</p>
</li>
<li>
<p>They exhibit contact response:
a tendency to avoid intersecting with other bodies.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When physics simulation detects a collision between
2 responsive bodies, it applies powerful
"contact forces" in an attempt to separate them.</p>
</div>
<div class="paragraph">
<p>For a simple example demonstrating all 5 features of rigid bodies, see
<a href="https://github.com/stephengold/Minie/blob/master/MinieExamples/src/main/java/jme3utilities/tutorial/HelloRigidBody.java">HelloRigidBody.java</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuring_rigid_bodies"><a class="anchor" href="#_configuring_rigid_bodies"></a>Configuring rigid bodies</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To create a static (non-moving) rigid body, specify <code>mass=0</code> in the constructor.</p>
</div>
<div class="paragraph">
<p>For a simple example combining static and dynamic rigid bodies, see
<a href="https://github.com/stephengold/Minie/blob/master/MinieExamples/src/main/java/jme3utilities/tutorial/HelloStaticBody.java">HelloStaticBody.java</a>.</p>
</div>
<div class="sect2">
<h3 id="_position"><a class="anchor" href="#_position"></a>Position</h3>
<div class="paragraph">
<p>Every rigid body occupies a position in space, described by 2 properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the location of the body&#8217;s center and</p>
</li>
<li>
<p>the rotation (orientation) of its local axes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Both these properties can be independently configured:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">body.setPhysicsLocation(new Vector3f(5f, 1f, 0f));
body.setPhysicsRotation(new Quaternion(0.5f, 0.5f, 0.5f, 0.5f));</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once a dynamic or static body has been initialized, of course,
it shouldn&#8217;t be repositioned in this manner.
A kinematic (externally driven) body, on the other hand,
may be repositioned for every timestep.</p>
</div>
<div class="paragraph">
<p>The center of a dynamic body should be located at its
<a href="https://en.wikipedia.org/wiki/Center_of_mass">center of mass</a>,
the point around which it tends to spin,
and its local axes should correspond to its
<a href="https://en.wikipedia.org/wiki/Principal_axis_(mechanics)">principal axes</a>.</p>
</div>
<div class="paragraph">
<p>A static or kinematic body allows more flexibility
in the choice of its center and local axes.</p>
</div>
</div>
<div class="sect2">
<h3 id="_kinematic_flag"><a class="anchor" href="#_kinematic_flag"></a>Kinematic flag</h3>
<div class="paragraph">
<p>To convert a dynamic rigid body into a kinematic one,
use <code>setKinematic(true)</code>.</p>
</div>
<div class="paragraph">
<p>For a simple example combining kinematic and dynamic rigid bodies, see
<a href="https://github.com/stephengold/Minie/blob/master/MinieExamples/src/main/java/jme3utilities/tutorial/HelloKinematics.java">HelloKinematics.java</a>.</p>
</div>
<div class="paragraph">
<p>To convert a static rigid body into a kinematic one, set its mass
to a positive value <strong>before</strong> setting its kinematic flag:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">body.setMass(1f);
body.setKinematic(true);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_contact_response"><a class="anchor" href="#_contact_response"></a>Contact response</h3>
<div class="paragraph">
<p>To disable the contact response of a rigid body,
use <code>setContactResponse(false)</code>.</p>
</div>
<div class="paragraph">
<p>For a simple demonstration of this feature, see
<a href="https://github.com/stephengold/Minie/blob/master/MinieExamples/src/main/java/jme3utilities/tutorial/HelloContactResponse.java">HelloContactResponse.java</a>.</p>
</div>
<div class="paragraph">
<p>The ball falls until it collides with the blue (static) box,
which provides a contact force to counteract gravity.
Press the spacebar to disable the ball&#8217;s contact response.
Once this happens, the box no longer exerts any force on the ball.
Gravity takes over, and the ball falls through the box.</p>
</div>
</div>
<div class="sect2">
<h3 id="_velocity"><a class="anchor" href="#_velocity"></a>Velocity</h3>
<div class="paragraph">
<p>Every dynamic body has a velocity, which quantifies how it is moving at the
present instant.</p>
</div>
<div class="paragraph">
<p>More precisely, it has 2 velocities: "linear velocity" and "angular velocity",
both represented as 3-D vectors.
The magnitude and direction of the linear velocity vector describe the speed
and direction at which its center is traveling through space, if at all.
The magnitude and direction of the angular velocity vector describe the
rate and axis of the body&#8217;s spinning motion, if any.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Both velocities of a static body are zero.</p>
</li>
<li>
<p>The velocities of a kinematic body are undefined.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_damping"><a class="anchor" href="#_damping"></a>Damping</h3>
<div class="paragraph">
<p>In the absence of external forces,
the velocities of a dynamic body would be constant.
However, we&#8217;re accustomed to seeing moving objects eventually come to rest.
This behavior is partly caused by drag forces such as air resistance.</p>
</div>
<div class="paragraph">
<p>To simulate drag forces, each dynamic rigid body includes damping,
which quantifies how fast its motion (if any) decays.</p>
</div>
<div class="paragraph">
<p>More precisely, each body has 2 damping parameters:
"linear damping" and "angular damping",
each of which ranges from zero (no drag) to one (motion ceases).</p>
</div>
<div class="paragraph">
<p>Minie provides accessors for both parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">rigidBody.setAngularDamping(0.5f);  // default=0
rigidBody.setLinearDamping(0.2f);   // default=0
rigidBody.setDamping(linearDamping, angularDamping);</code></pre>
</div>
</div>
<div class="paragraph">
<p>TODO tutorial app</p>
</div>
</div>
<div class="sect2">
<h3 id="_gravity"><a class="anchor" href="#_gravity"></a>Gravity</h3>
<div class="paragraph">
<p>However, we&#8217;re accustomed to seeing unsupported objects fall
under the influence of gravity.</p>
</div>
<div class="paragraph">
<p>To simulate this phenomenon, each body has a gravity vector,
which (if the body is dynamic) applies a continual downward acceleration.
To configure a body&#8217;s gravity, use <code>setGravity(accelerationVector)</code>.
If following the Y-up convention, the X and Z components of the
vector should be zero, and its Y component should be <strong>negative</strong>.</p>
</div>
<div class="paragraph">
<p>When a body is added to a <code>PhysicsSpace</code>,
the gravity of the space typically gets applied to it,
replacing any previously configured gravity.
To protect a rigid body from gravity changes caused by the space
to which it&#8217;s added, use <code>setProtectGravity(true)</code>.</p>
</div>
<div class="paragraph">
<p>To simulate a non-uniform gravitational field,
update the gravity of each body prior to each physics tick.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public void prePhysicsTick(PhysicsSpace space, float timeStep) {
    Collection&lt;PhysicsCollisionObject&gt; pcos = space.getPcoList();
    for (PhysicsCollisionObject pco : pcos) {
        if (pco instanceof PhysicsBody) {
            updateGravity((PhysicsBody) pco);
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>TODO non-u example app</p>
</div>
</div>
<div class="sect2">
<h3 id="_restitution"><a class="anchor" href="#_restitution"></a>Restitution</h3>
<div class="paragraph">
<p>When bodies collide, contact forces come into play, altering their velocities.
Restitution is the contact force perpendicular to the collision plane.
Its strength depends on what the bodies are made out of.</p>
</div>
<div class="paragraph">
<p>If both bodies were composed of hard, springy steel,
they might separate without loss of energy,
after what&#8217;s called a "perfectly elastic" collision.
If, on the other hand, both bodies were made of soft, sticky clay,
they might cling together,
resulting in what&#8217;s called a "perfectly inelastic" collision.</p>
</div>
<div class="paragraph">
<p>In reality, no collision is perfectly elastic.
Elasticity is quantified by a "coefficient of restitution",
which ranges from zero (perfectly inelastic) to one (perfectly elastic).</p>
</div>
<div class="paragraph">
<p>In Minie and Bullet, collisions are perfectly inelastic by default.
(We saw this in <a href="https://github.com/stephengold/Minie/blob/master/MinieExamples/src/main/java/jme3utilities/tutorial/HelloRigidBody.java">HelloRigidBody.java</a>.)
Each rigid body has a restitution parameter (which defaults to zero),
and the coefficient of restitution is determined by multiplying the parameters
of the colliding bodies.</p>
</div>
<div class="paragraph">
<p>To simulate a perfectly elastic collision, set the restitution parameters of
both bodies to one:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">rigidBodyA.setRestitution(1f); // default=0
rigidBodyB.setRestitution(1f);</code></pre>
</div>
</div>
<div class="paragraph">
<p>To see perfectly elastic collisions, run
<a href="https://github.com/stephengold/Minie/blob/master/MinieExamples/src/main/java/jme3utilities/NewtonsCradle.java">the Newton&#8217;s Cradle demo</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_friction"><a class="anchor" href="#_friction"></a>Friction</h3>
<div class="paragraph">
<p>Just as restitution models the component of the contact force
perpendicular to the collision plane,
friction models the component that lies <strong>in</strong> the plane.</p>
</div>
<div class="paragraph">
<p>Each rigid body has a friction parameter (which defaults to 0.5),
and the coefficient of friction is determined by adding the parameters
of the colliding bodies.
Reducing a body&#8217;s friction parameter makes it more slippery (think wet ice).
Increasing it results in better traction (think sandpaper or rubber).</p>
</div>
<div class="paragraph">
<p>Modeling friction is more complicated than modeling restitution because
friction can generate both contact forces and contact torques.
In addition to its basic friction parameter,
each rigid body also has 2 additional friction parameters:
one for rolling friction and one for spinning frction.
Both parameters default to zero.</p>
</div>
<div class="paragraph">
<p>Rolling friction creates torque orthogonal to the contact normal,
which tends to slow down a rolling body.
Spinning friction creates torque parallel to the contact normal,
which tends to prevent a body from spinning when grasped.</p>
</div>
<div class="paragraph">
<p>Minie provides accessors for the 3 parameters described above:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">rigidBody.setFriction(5f);          // default=0.5
rigidBody.setRollingFriction(10f);  // default=0
rigidBody.setSpinningFriction(50f); // default=0</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using numpad keys, you can vary the damping, friction, gravity,
and restitution of the dropped bodies in
<a href="https://github.com/stephengold/Minie/blob/master/MinieExamples/src/main/java/jme3utilities/NewtonsCradle.java">the DropTest demo</a>
and see how these parameters affect their motion.</p>
</div>
<div class="paragraph">
<p>To see rolling and spinning friction in action, run
<a href="https://github.com/stephengold/Minie/blob/master/MinieExamples/src/main/java/jme3utilities/PoolDemo.java">the PoolDemo application</a>.</p>
</div>
<div class="paragraph">
<p>TODO contact damping/processing/stiffness, sleeping/activation, CCD, RigidBodyControl</p>
</div>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>Copyright 2020 Stephen Gold</p>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
