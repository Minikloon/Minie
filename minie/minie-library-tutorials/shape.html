<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Choosing collision shapes :: The Minie project</title>
    <link rel="canonical" href="https://stephengold.github.io/Minie/minie/minie-library-tutorials/shape.html">
    <meta name="generator" content="Antora 2.3.3">
    <link rel="stylesheet" href="../../_/css/site.css">
<meta property="og:image" content="../../_/img/iconx128.png">
<meta property="og:description" content="Choosing collision shapes">
<meta property="og:title" content="The Minie project">
<link rel="icon" href="../../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://stephengold.github.io/Minie">
        <img alt="" src="../../_/img/iconx128.png" width="32" type="image/x-icon" style="margin-right:16px">
        The Minie project
      </a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item theme-switch-wrapper">
          <label class="theme-switch" for="checkbox">
            <input type="checkbox" id="checkbox"/>
            <div class="slider round"></div>
          </label>
          <p class="navlabel">light/dark mode</em>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="minie" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../overview.html">The Minie project</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://github.com/stephengold/Minie">Git repository</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://raw.githubusercontent.com/stephengold/Minie/master/LICENSE">License</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://github.com/stephengold/Minie/releases/latest">Latest release</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://github.com/stephengold/Minie/blob/master/MinieLibrary/release-notes.md">Release log</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://github.com/stephengold/Minie/issues">Issue tracker</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://hub.jmonkeyengine.org/c/user-code-projects/minie/63">Forum</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Library tutorials</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="add.html">Add to existing project</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="rigidbody.html">Rigid bodies</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="shape.html">Collision shapes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="rbc.html">RigidBodyControl</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="debug.html">Debugging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="new6dof.html">New6Dof joints</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dac.html">Ragdolls</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="detect.html">Collision detection</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="softbody.html">Soft bodies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="misc.html">Miscellany</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://stephengold.github.io/Minie/minie/javadoc">Library API</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Minie at other sites</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://bintray.com/stephengold/com.github.stephengold/Minie">Bintray</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://jitpack.io/#stephengold/Minie">JitPack</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://jmonkeystore.com/38308161-c3cf-4e23-8754-528ca8387c11">JmonkeyStore</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Related projects</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://jmonkeyengine.org">JMonkeyEngine</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/stephengold/Libbulletjme">Libbulletjme</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://pybullet.org/wordpress">Bullet</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/kmammou/v-hacd">V-HACD</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/stephengold/Heart">Heart</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://jmonkeystore.com/4477514f-a3ae-4d42-b928-d3a62335159f">Advanced vehicles</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://jmonkeystore.com/1a85df6f-4bb6-4c85-9e77-b5119662ed54">Blocks</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">The Minie project</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">The Minie project</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../overview.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../overview.html">The Minie project</a></li>
    <li>Library tutorials</li>
    <li><a href="shape.html">Collision shapes</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/stephengold/Minie/edit/master/MinieLibrary/src/site/antora/tutorials/modules/minie-library-tutorials/pages/shape.adoc">Edit this page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Choosing collision shapes</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>A <em>collision shape</em>
describes the shape and size of a collision object such as a rigid body.
The examples so far have all used spheres and/or cubes.
However, there are actually 16 subclasses of
<a href="https://stephengold.github.io/Minie/minie/javadoc/com/jme3/bullet/collision/shapes/CollisionShape.html"><code>CollisionShape</code></a>.
Here they are in lexicographic order,
with key characteristics and illustrations:</p>
</div>
<table class="tableblock frame-all grid-none stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1. <a href="https://stephengold.github.io/Minie/minie/javadoc/com/jme3/bullet/collision/shapes/Box2dShape.html"><code>Box2dShape</code></a></p>
<p class="tableblock">&rarr; convex<br>
&rarr; positive margin<br>
&rarr; precise<br>
&rarr; fully scalable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="_images/box2d.png" alt="box2d" height="160"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2. <a href="https://stephengold.github.io/Minie/minie/javadoc/com/jme3/bullet/collision/shapes/BoxCollisionShape.html"><code>BoxCollisionShape</code></a></p>
<p class="tableblock">&rarr; convex<br>
&rarr; positive margin<br>
&rarr; precise<br>
&rarr; fully scalable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="https://i.imgur.com/My74h2Q.png" alt="My74h2Q" height="160"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3. <a href="https://stephengold.github.io/Minie/minie/javadoc/com/jme3/bullet/collision/shapes/CapsuleCollisionShape.html"><code>CapsuleCollisionShape</code></a></p>
<p class="tableblock">&rarr; convex<br>
&rarr; zero margin<br>
&rarr; precise<br>
&rarr; uniform scaling only</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="https://i.imgur.com/R9NMEwc.png" alt="R9NMEwc" height="160"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4. <a href="https://stephengold.github.io/Minie/minie/javadoc/com/jme3/bullet/collision/shapes/CompoundCollisionShape.html"><code>CompoundCollisionShape</code></a></p>
<p class="tableblock">&rarr; neither concave nor convex<br>
&rarr; positive margin<br>
&rarr; precise if-and-only-if all of its children are precise<br>
&rarr; scalable to the extent that all of its children are scalable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="https://i.imgur.com/gL6rgAA.png" alt="gL6rgAA" height="160"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5. <a href="https://stephengold.github.io/Minie/minie/javadoc/com/jme3/bullet/collision/shapes/ConeCollisionShape.html"><code>ConeCollisionShape</code></a></p>
<p class="tableblock">&rarr; convex<br>
&rarr; positive margin<br>
&rarr; imprecise<br>
&rarr; uniform scaling only</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="https://i.imgur.com/jZFVxQd.png" alt="jZFVxQd" height="160"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6. <a href="https://stephengold.github.io/Minie/minie/javadoc/com/jme3/bullet/collision/shapes/Convex2dShape.html"><code>Convex2dShape</code></a></p>
<p class="tableblock">&rarr; convex<br>
&rarr; positive margin<br>
&rarr; imprecise<br>
&rarr; scalable to the extent that its base shape is scalable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="_images/convex2d.png" alt="convex2d" height="160"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7. <a href="https://stephengold.github.io/Minie/minie/javadoc/com/jme3/bullet/collision/shapes/CylinderCollisionShape.html"><code>CylinderCollisionShape</code></a></p>
<p class="tableblock">&rarr; convex<br>
&rarr; positive margin<br>
&rarr; imprecise<br>
&rarr; limited scalability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="https://i.imgur.com/ey249X8.png" alt="ey249X8" height="160"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8. <a href="https://stephengold.github.io/Minie/minie/javadoc/com/jme3/bullet/collision/shapes/EmptyShape.html"><code>EmptyShape</code></a></p>
<p class="tableblock">&rarr; concave<br>
&rarr; positive margin<br>
&rarr; precise<br>
&rarr; fully scalable, but why bother?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(no image)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">9. <a href="https://stephengold.github.io/Minie/minie/javadoc/com/jme3/bullet/collision/shapes/GImpactCollisionShape.html"><code>GImpactCollisionShape</code></a></p>
<p class="tableblock">&rarr; concave<br>
&rarr; positive margin<br>
&rarr; precise<br>
&rarr; fully scalable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="https://i.imgur.com/TOLRsig.png" alt="TOLRsig" height="160"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10. <a href="https://stephengold.github.io/Minie/minie/javadoc/com/jme3/bullet/collision/shapes/HeightfieldCollisionShape.html"><code>HeightfieldCollisionShape</code></a></p>
<p class="tableblock">&rarr; concave<br>
&rarr; positive margin<br>
&rarr; precise<br>
&rarr; fully scalable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="https://i.imgur.com/JwtpqOM.png" alt="JwtpqOM" height="160"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">11. <a href="https://stephengold.github.io/Minie/minie/javadoc/com/jme3/bullet/collision/shapes/HullCollisionShape.html"><code>HullCollisionShape</code></a></p>
<p class="tableblock">&rarr; convex<br>
&rarr; positive margin<br>
&rarr; imprecise<br>
&rarr; fully scalable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="https://i.imgur.com/Rf61rcw.png" alt="Rf61rcw" height="160"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">12. <a href="https://stephengold.github.io/Minie/minie/javadoc/com/jme3/bullet/collision/shapes/MeshCollisionShape.html"><code>MeshCollisionShape</code></a></p>
<p class="tableblock">&rarr; concave<br>
&rarr; positive margin<br>
&rarr; precise<br>
&rarr; fully scalable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="https://i.imgur.com/glB3Ujk.png" alt="glB3Ujk" height="160"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">13. <a href="https://stephengold.github.io/Minie/minie/javadoc/com/jme3/bullet/collision/shapes/MultiSphere.html"><code>MultiSphere</code></a></p>
<p class="tableblock">&rarr; convex<br>
&rarr; positive margin<br>
&rarr; precise<br>
&rarr; fully scalable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="https://i.imgur.com/nTZEc8C.png" alt="nTZEc8C" height="160"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">14. <a href="https://stephengold.github.io/Minie/minie/javadoc/com/jme3/bullet/collision/shapes/PlaneCollisionShape.html"><code>PlaneCollisionShape</code></a></p>
<p class="tableblock">&rarr; concave and infinite<br>
&rarr;  positive margin<br>
&rarr;  precise<br>
&rarr;  fully scalable, but why bother?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="_images/plane.png" alt="plane" height="160"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">15. <a href="https://stephengold.github.io/Minie/minie/javadoc/com/jme3/bullet/collision/shapes/SimplexCollisionShape.html"><code>SimplexCollisionShape</code></a></p>
<p class="tableblock">&rarr; convex<br>
&rarr; positive margin<br>
&rarr; imprecise<br>
&rarr; not scalable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="https://i.imgur.com/l1fYSfc.png" alt="l1fYSfc" height="160"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">16. <a href="https://stephengold.github.io/Minie/minie/javadoc/com/jme3/bullet/collision/shapes/SphereCollisionShape.html"><code>SphereCollisionShape</code></a></p>
<p class="tableblock">&rarr; convex<br>
&rarr; zero margin<br>
&rarr; precise<br>
&rarr; uniform scaling only</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="https://i.imgur.com/OPYrxRe.png" alt="OPYrxRe" height="160"></span></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In this context,
<em>concave</em> doesn&#8217;t imply that the shape in question must be
<a href="https://en.wikipedia.org/wiki/Convex_set#Non-convex_set">non-convex in the mathematical sense</a>.
Rather, it is a property of specific <code>CollisionShape</code> subclasses.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_suitability_for_dynamic_bodies"><a class="anchor" href="#_suitability_for_dynamic_bodies"></a>Suitability for dynamic bodies</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Not all collision shapes are suitable for dynamic rigid bodies.</p>
</div>
<div class="paragraph">
<p>In particular, the following shapes are suitable <strong>only</strong>
for kinematic or static collision objects because
Bullet cannot calculate their mass distributions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>EmptyShape</code></p>
</li>
<li>
<p><code>HeightfieldCollisionShape</code></p>
</li>
<li>
<p><code>MeshCollisionShape</code></p>
</li>
<li>
<p><code>PlaneCollisionShape</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Furthermore,
collision detection doesn&#8217;t work well between zero-thickness shapes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Box2dShape</code></p>
</li>
<li>
<p><code>Convex2dShape</code></p>
</li>
<li>
<p><code>SimplexCollisionShape</code> with 1-3 vertices</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There are many non-symmetric shapes
that can be applied to dynamic rigid bodies.
With such shapes, however, care should be taken to ensure
that the center and principal axes are reasonable:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CompoundCollisionShape</code></p>
</li>
<li>
<p><code>GImpactCollisionShape</code></p>
</li>
<li>
<p><code>HullCollisionShape</code></p>
</li>
<li>
<p><code>MultiSphere</code></p>
</li>
<li>
<p><code>SimplexCollisionShape</code> with 4 vertices</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>At the very least,
the shape&#8217;s center should be located <strong>inside</strong> its convex hull.</p>
</div>
<div class="paragraph">
<p>The safest shapes for dynamic rigid bodies are the <em>primitives</em>,
since their centers and principal axes are known:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>BoxCollisionShape</code></p>
</li>
<li>
<p><code>CapsuleCollisionShape</code></p>
</li>
<li>
<p><code>ConeCollisionShape</code></p>
</li>
<li>
<p><code>CylinderCollisionShape</code></p>
</li>
<li>
<p><code>SphereCollisionShape</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_margin"><a class="anchor" href="#_margin"></a>Margin</h2>
<div class="sectionbody">
<div class="paragraph">
<p>All collision shapes except <code>CapsuleCollisionShape</code> and <code>SphereCollisionShape</code>
incorporate a <em>collision margin</em>.
According to the Bullet Manual, the purpose of margin is
"to improve performance and reliability of the collision detection."</p>
</div>
<div class="paragraph">
<p>For all shapes with margin, the default margin is 0.04 physics-space units.
Methods are provided to adjust their margins, but doing so is not recommended.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_precise_shapes"><a class="anchor" href="#_precise_shapes"></a>Precise shapes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A <em>precise shape</em> is a collision shape whose effective shape
(as determined by collisions, contact tests, ray tests, and sweep tests)
is unaffected by margin.</p>
</div>
<div class="paragraph">
<p>While most of the <code>CollisionShape</code> subtypes are precise,
there are 5 that are not.
For 4 of them, margin simply bloats their effective shapes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ConeCollisionShape</code></p>
</li>
<li>
<p><code>Convex2dShape</code></p>
</li>
<li>
<p><code>HullCollisionShape</code></p>
</li>
<li>
<p><code>SimplexCollisionShape</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Margin also distorts a <code>CylinderCollisionShape</code>,
but its effect on size is more complicated.</p>
</div>
<div class="paragraph">
<p>Since margin is defined in physics-space units,
its distortions are most noticeable for small shapes.</p>
</div>
<div class="paragraph">
<p>When using imprecise shapes, you may want to compensate for margin
by shrinking the shape&#8217;s dimensions
(for a <code>ConeCollisionShape</code> or <code>CylinderCollisionShape</code>)
or by moving its defining vertices inward
(for a <code>SimplexCollisionShape</code> or <code>HullCollisionShape</code>).</p>
</div>
<div class="paragraph">
<p>Another possible workaround would be to scale the physics space so that
the effects of margin become less obvious.</p>
</div>
<div class="sect2">
<h3 id="_scaling"><a class="anchor" href="#_scaling"></a>Scaling</h3>
<div class="paragraph">
<p>Some applications require collision shapes that are <em>scalable</em>
(can be dynamically shrunk or enlarged).
However, not all collision shapes can scale arbitrarily.
In particular:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>SimplexCollisionShape</code> doesn&#8217;t support scaling at all;
the only allowed scaling is (1,1,1).</p>
</li>
<li>
<p><code>CapsuleCollisionShape</code>, <code>ConeCollisionShape</code>, and <code>SphereCollisionShape</code>
support only uniform scaling, where all axes have the same scale factor.
For instance, (0.2,0.2,0.2) or (9,9,9).</p>
</li>
<li>
<p><code>CylinderCollisionShape</code> allows the height and base to scale independently,
but the scale factors of both base axes must be equal.
In other words, the cross section must remain circular.
So (9,9,9) would be allowed for any cylinder,
but (9,1,1) would be allowed only for cylinders
where the local X axis is the height axis.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can test at runtime whether a particular scaling
is applicable to particular shape:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">if (shape.canScale(newScale)) {
    shape.setScale(newScale);
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_choosing_a_shape"><a class="anchor" href="#_choosing_a_shape"></a>Choosing a shape</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For efficient simulation, the general rule is:
"Use the simplest shape that yields the desired <strong>behavior</strong>."
By focusing on behavior rather than appearance,
you may avoid modeling details that don&#8217;t matter.
For instance:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If a glass bottle stays sealed, its collision shape need not be hollow.</p>
</li>
<li>
<p>A character&#8217;s hair should probably be omitted from their collision shape.</p>
</li>
<li>
<p>Any small shape that only encounters large, flat surfaces
can probably be approximated by a convex hull.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Because jMonkeyEngine models are composed of triangular meshes,
beginners are often tempted to use mesh-based shapes
(such as <code>GImpactCollisionShape</code>) for everything.
However, since mesh-based collision detection is CPU-intensive, primitive
convex shapes (such as boxes and spheres) are usually a better choice, even
when they don&#8217;t match the model&#8217;s shape exactly.
In particular, <code>CapsuleCollisionShape</code> is often used with humanoid models.</p>
</div>
<div class="paragraph">
<p>The following pseudo-code algorithm may be helpful:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>if (the object doesn't move and isn't involved in collisions) {
    use an EmptyShape or don't add the object to the space
} else if (the object doesn't move
           and its shape can be approximated by an infinite plane) {
    use a PlaneCollisionShape
} else if (the object doesn't move
          and its shape can be approximated by point, line segment, or triangle) {
    use a SimplexCollisionShape
} else if (the object doesn't move
           and its shape can be approximated by rectangle) {
    use a Box2dShape
} else if (the object doesn't move
           and its shape can be approximated by 2-D convex polygon) {
    use a Convex2dShape
} else if (its shape can be approximated by a tetrahedron) {
    use a SimplexCollisionShape
} else if (its shape can be approximated by a centered sphere) {
    use a SphereCollisionShape
} else if (its shape can be approximated by a centered rectangular solid) {
    use a BoxCollisionShape
} else if (its shape can be approximated by a centered capsule) {
    use a CapsuleCollisionShape
} else if (its shape can be approximated by a centered cylinder) {
    use a CylinderCollisionShape
} else if (its shape can be approximated by a centered cone) {
    use a ConeCollisionShape
} else if (its shape can be approximated by an ellipsoid
           or an eccentric sphere
           or an eccentric capsule
           or the convex hull of multiple spheres) {
    use a MultiSphere
} else if (its shape can be approximated by an eccentric primitive
           or a combination of convex primitives) {
    use a CompoundCollisionShape
} else if (the object does not move) {
    if (it is a 2-D heightfield) {
        use a HeightfieldCollisionShape
    } else {
        use a MeshCollisionShape
    }
} else { // if the object moves
    if (its shape can be approximated by a convex hull) {
        use a HullCollisionShape
    } else if (its shape can be decomposed into convex hulls) {
        use a compound of hull shapes
    } else {
        use a GImpactCollisionShape
    }
}</pre>
</div>
</div>
<div class="paragraph">
<p>(Pseudocode adapted from the flowchart on page 13 of
<a href="https://github.com/bulletphysics/bullet3/blob/master/docs/Bullet_User_Manual.pdf">the Bullet User Manual</a>.)</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>GImpactCollisionShape</code> should be your last resort!
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_convex_decomposition"><a class="anchor" href="#_convex_decomposition"></a>Convex decomposition</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Faced with simulating a non-convex object such as a ring,
the it&#8217;s best to decompose it into convex shapes that,
when recombined, will approximate the desired behavior.</p>
</div>
<div class="paragraph">
<p>There are various approaches,
depending on what the developer knows about the object&#8217;s shape.
If the object&#8217;s mesh is generated procedurally, it may be possible
to decompose it during the generation process.
Or if the object is modelled in Blender,
it may be practical to manually decompose it there
into meshes that are convex or nearly so.
In those cases, the desired compound shape can be generated using
<code>CollisionShapeFactory.createDynamicMeshShape()</code>.</p>
</div>
<div class="paragraph">
<p>For situations where manual decomposition is impractical,
Minie incorporates Khaled Mamou&#8217;s
<a href="https://github.com/kmammou/v-hacd">Volumetric-Hierarchical Approximate Convex Decomposition (V-HACD) algorithm</a>.
V-HACD makes it easy to decompose a 3-D model into a
compound of hull shapes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">VHACDParameters parms = new VHACDParameters();
CollisionShape shape
        = CollisionShapeFactory.createVhacdShape(modelRoot, parms, null);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The V-HACD algorithm is costly to run, but in many applications it can
be run during in advance and stored in J3O format until needed.
During simulation, the resulting shape will usually be much more efficient
than a <code>GImpactCollisionShape</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_summary"><a class="anchor" href="#_summary"></a>Summary</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Minie provides 16 types of collision shapes,
ranging from the trivial <code>EmptyShape</code> to the costly <code>GImpactCollisionShape</code>.</p>
</li>
<li>
<p>Not all collision shapes are suitable for dynamic rigid bodies.</p>
</li>
<li>
<p>When applying a non-symmetric shape to a dynamic rigid body,
make sure that the center and principal axes are reasonable.</p>
</li>
<li>
<p>Most collision shapes incorporate a margin, and in some cases the
margin distorts the effective shape, making it imprecise.</p>
</li>
<li>
<p>Most collision shapes can be scaled, but not all can be scaled non-uniformly.</p>
</li>
<li>
<p>Use the simplest shape that yields the desired behavior.</p>
</li>
<li>
<p>To speed up simulation of objects with non-convex shapes,
decompose them into convex ones, either by hand or using V-HACD.</p>
</li>
</ul>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>Copyright 2020 Stephen Gold</p>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
