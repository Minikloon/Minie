<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>An introduction to RigidBodyControl :: The Minie project</title>
    <link rel="canonical" href="https://stephengold.github.io/Minie/minie/minie-library-tutorials/rbc.html">
    <meta name="generator" content="Antora 2.3.3">
    <link rel="stylesheet" href="../../_/css/site.css">
<meta property="og:image" content="../../_/img/iconx128.png">
<meta property="og:description" content="An introduction to <code>RigidBodyControl</code>">
<meta property="og:title" content="The Minie project">
<link rel="icon" href="../../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://stephengold.github.io/Minie">
        <img alt="" src="../../_/img/iconx128.png" width="32" type="image/x-icon" style="margin-right:16px">
        The Minie project
      </a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item theme-switch-wrapper">
          <label class="theme-switch" for="checkbox">
            <input type="checkbox" id="checkbox"/>
            <div class="slider round"></div>
          </label>
          <p class="navlabel">light/dark mode</em>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="minie" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../overview.html">The Minie project</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://github.com/stephengold/Minie">Git repository</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://raw.githubusercontent.com/stephengold/Minie/master/LICENSE">License</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://github.com/stephengold/Minie/releases/latest">Latest release</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://github.com/stephengold/Minie/blob/master/MinieLibrary/release-notes.md">Release log</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://github.com/stephengold/Minie/issues">Issue tracker</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://hub.jmonkeyengine.org/c/user-code-projects/minie/63">Forum</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Library tutorials</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="add.html">Add to existing project</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="rigidbody.html">Rigid bodies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="shape.html">Collision shapes</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="rbc.html">RigidBodyControl</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="debug.html">Debugging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="character.html">Characters</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="vehicle.html">Vehicles</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="new6dof.html">New6Dof joints</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dac.html">Ragdolls</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="detect.html">Collision detection</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="softbody.html">Soft bodies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="misc.html">Miscellany</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://stephengold.github.io/Minie/minie/javadoc">Library API</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Minie at other sites</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://bintray.com/stephengold/com.github.stephengold/Minie">Bintray</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://jitpack.io/#stephengold/Minie">JitPack</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://jmonkeystore.com/38308161-c3cf-4e23-8754-528ca8387c11">JmonkeyStore</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Related projects</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://jmonkeyengine.org">JMonkeyEngine</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/stephengold/Libbulletjme">Libbulletjme</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://pybullet.org/wordpress">Bullet</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/kmammou/v-hacd">V-HACD</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/stephengold/Heart">Heart</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://jmonkeystore.com/4477514f-a3ae-4d42-b928-d3a62335159f">Advanced vehicles</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://jmonkeystore.com/1a85df6f-4bb6-4c85-9e77-b5119662ed54">Blocks</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">The Minie project</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">The Minie project</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../overview.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../overview.html">The Minie project</a></li>
    <li>Library tutorials</li>
    <li><a href="rbc.html">RigidBodyControl</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/stephengold/Minie/edit/master/MinieLibrary/src/site/antora/tutorials/modules/minie-library-tutorials/pages/rbc.adoc">Edit this page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">An introduction to <code>RigidBodyControl</code></h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>By themselves, collision objects are invisible,
while scene-graph spatials have no effect on physics.
To visualize a collision object, it must be associated
with one or more scene-graph spatial(s).
Such associations are implemented using <em>physics controls</em>:
scene-graph controls that implement the
{url-api}/control/PhysicsControl.html[<code>PhysicsControl</code>] interface.</p>
</div>
<div class="paragraph">
<p>To associate a rigid body with a <code>Spatial</code>, there&#8217;s a
{url-api}/control/RigidBodyControl.html[<code>RigidBodyControl</code>] class that extends
{url-api}/objects/PhysicsRigidBody.html[<code>PhysicsRigidBody</code>] and implements
{url-api}/control/PhysicsControl.html[<code>PhysicsControl</code>].</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In this case, the physics control and its collision object
are the same object!
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Because each {url-api}/control/RigidBodyControl.html[<code>RigidBodyControl</code>] (RBC)
instance is a rigid body, you can configure it and add it to a space
just like a directly instantiated rigid body.
Adding the control to a <code>Spatial</code> synchronizes the motion of the rigid body
with that of the <code>Spatial</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_constructors"><a class="anchor" href="#_constructors"></a>Constructors</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are 3 {url-api}/control/RigidBodyControl.html[<code>RigidBodyControl</code>]
constructors:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">rbc1 = new RigidBodyControl(collisionShape, mass);
rbc2 = new RigidBodyControl(collisionShape);
rbc3 = new RigidBodyControl(mass);
---

If you specify `mass &gt; 0`, a dynamic rigid body is created.
If you specify `mass = 0`, a static one is created.
If you construct an RBC without specifying a mass,
you get a dynamic body with `mass = 1`.

If you construct an RBC without specifying a collision shape,
you get an incomplete body.

NOTE: Adding an incomplete body to a physics space will cause an crash!

To complete the body,
simply add the control to a `Spatial` (*before* adding it to a space).
A collision shape will be created based on the controlled spatial,
using `CollisionShapeFactory.createDynamicMeshShape()` (for a dynamic body)
or `CollisionShapeFactory.createMeshShape()` (for a static one).

{url-tutorial}/HelloRbc.java[HelloRbc] is a simple
application that demonstrates the use of
{url-api}/control/RigidBodyControl.html[`RigidBodyControl`].
Things to notice while running the app:

. The collision objects behave like directly instantiated rigid bodies.
. Each geometry matches the motion of its corresponding physics object.

== Kinematic flags

To create a physics control for a *kinematic* rigid body,
first instantiate a dynamic RBC (with `mass &gt; 0`),
then convert it to kinematic using `rigidBodyControl.setKinematic(true)`.

{url-tutorial}/HelloKinematicRbc.java[HelloKinematicRbc] is a simple
application that demonstrates a kinematic RBC.

By default, the physics object of a kinematic RBC
follows the motion of its controlled spatial.
To reposition it, you must reposition the `Spatial`.

To avoid this behavior, use `setKinematicSpatial(false)`.
The body will remain kinematic,
but it will no longer match the motion of the controlled spatial.
The body can then be positioned directly,
using `setPhysicsLocation()` and `setPhysicsRotation()`.

== The "apply scale" option

While the *motion* of the controlled spatial matches
that of the body, their *sizes* might differ.
By default, there's no connection between the scale of the controlled spatial
and the scale of the body's collision shape.

To match those scales, use `setApplyScale(true)`.

{url-tutorial}/HelloApplyScale.java[HelloKinematicRbc] is a simple
application that demonstrates `setApplyScale()`.
Things to notice while running the app:

. The rigid body is visualized as a blue wireframe.
. The controlled geometry is solid white.
. The size of the rigid body matches that of the controlled geometry.

== Local physics

By default, a rigid-body control writes (or reads)
the *world* transform of its controlled spatial.

To write (or read) the spatial's *local* transform,
use `setApplyPhysicsLocal(true)`.

== Summary

* To associate a rigid body with a scene-graph spatial, use a
  {url-api}/control/RigidBodyControl.html[`RigidBodyControl`].
* If you construct an RBC without specifying a collision shape,
  it will be incomplete until it gets added to a `Spatial`.
* An RBC can be static, dynamic, or kinematic.
* Generally, the motion of the controlled spatial matches that of the body,
  but you can disable the spatial-following behavior of a kinematic RBC.
* To match the scales of the body and the controlled spatial,
  use `setApplyScale(true)`.
* To match with the spatial's local transform
   instead of its world transform, use `setApplyPhysicsLocal(true)`.</code></pre>
</div>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>Copyright 2020 Stephen Gold</p>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
