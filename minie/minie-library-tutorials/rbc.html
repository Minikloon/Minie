<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>An introduction to RigidBodyControl :: The Minie project</title>
    <link rel="canonical" href="https://stephengold.github.io/Minie/minie/minie-library-tutorials/rbc.html">
    <link rel="prev" href="shape.html">
    <link rel="next" href="debug.html">
    <meta name="generator" content="Antora 2.3.3">
    <link rel="stylesheet" href="../../_/css/site.css">
<meta property="og:image" content="../../_/img/iconx128.png">
<meta property="og:description" content="An introduction to <code>RigidBodyControl</code>">
<meta property="og:title" content="The Minie project">
<link rel="icon" href="../../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://stephengold.github.io/Minie">
        <img alt="" src="../../_/img/iconx128.png" width="32" type="image/x-icon" style="margin-right:16px">
        The Minie project
      </a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Color themes</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" onclick="setTheme('dark')">Dark</button>
            <a class="navbar-item" onclick="setTheme('jungle')">Jungle</button>
            <a class="navbar-item" onclick="setTheme('light')">Light</button>
            <a class="navbar-item" onclick="setTheme('pastel')">Pastel</button>
            <a class="navbar-item" onclick="setTheme('phosphor')">Phosphor</button>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="minie" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../overview.html">The Minie project</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../implementation.html">Implementation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Library tutorials</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="add.html">Add to existing project</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="rigidbody.html">Rigid bodies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="shape.html">Collision shapes</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="rbc.html">RigidBodyControl</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="debug.html">Debugging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="character.html">Characters</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="vehicle.html">Vehicles</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="new6dof.html">New6Dof joints</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dac.html">Ragdolls</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="detect.html">Collision detection</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="softbody.html">Soft bodies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="server.html">Physics without appstates</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="misc.html">Miscellany</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../build.html">Build procedures</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="https://github.com/stephengold/Minie">Git repository</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/stephengold/Minie/releases/latest">Latest release</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/stephengold/Minie/releases">Recent releases</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/stephengold/Minie/blob/master/README.md">ReadMe file</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://raw.githubusercontent.com/stephengold/Minie/master/LICENSE">License</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/stephengold/Minie/blob/master/MinieLibrary/release-notes.md">Release log</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/stephengold/Minie/commits/master">Recent commits</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/stephengold/Minie/issues">Issue tracker</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://stephengold.github.io/Minie/javadoc/master">Library API</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Minie at other sites</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://hub.jmonkeyengine.org/c/user-code-projects/minie/63">JMonkeyEngine forum</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://bintray.com/stephengold/com.github.stephengold/Minie">Bintray</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://jitpack.io/#stephengold/Minie">JitPack</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://jmonkeystore.com/38308161-c3cf-4e23-8754-528ca8387c11">JmonkeyStore</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Related projects</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://jmonkeyengine.org">JMonkeyEngine</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/stephengold/Libbulletjme">Libbulletjme</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://pybullet.org/wordpress">Bullet</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/kmammou/v-hacd">V-HACD</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/stephengold/Heart">Heart</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://jmonkeystore.com/4477514f-a3ae-4d42-b928-d3a62335159f">Advanced vehicles</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://jmonkeystore.com/1a85df6f-4bb6-4c85-9e77-b5119662ed54">Blocks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://github.com/stephengold/antora-ui-bundle">Site UI</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">The Minie project</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">The Minie project</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../overview.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../overview.html">The Minie project</a></li>
    <li>Library tutorials</li>
    <li><a href="rbc.html">RigidBodyControl</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/stephengold/Minie/edit/master/MinieLibrary/src/site/antora/tutorials/modules/minie-library-tutorials/pages/rbc.adoc">Edit this page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">An introduction to <code>RigidBodyControl</code></h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>By themselves, collision objects are invisible,
while scene-graph spatials have no effect on physics.
To visualize a collision object, it must be associated
with one or more scene-graph spatial(s).
Such associations are implemented using <em>physics controls</em>:
scene-graph controls that implement the
<a href="https://stephengold.github.io/Minie/javadoc/master/com/jme3/bullet/control/PhysicsControl.html"><code>PhysicsControl</code></a> interface.</p>
</div>
<div class="paragraph">
<p>To associate a rigid body with a <code>Spatial</code>, there&#8217;s a
<a href="https://stephengold.github.io/Minie/javadoc/master/com/jme3/bullet/control/RigidBodyControl.html"><code>RigidBodyControl</code></a> class that extends
<a href="https://stephengold.github.io/Minie/javadoc/master/com/jme3/bullet/objects/PhysicsRigidBody.html"><code>PhysicsRigidBody</code></a> and implements
<a href="https://stephengold.github.io/Minie/javadoc/master/com/jme3/bullet/control/PhysicsControl.html"><code>PhysicsControl</code></a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In this case, the physics control and its collision object
are the same object!
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Because each <a href="https://stephengold.github.io/Minie/javadoc/master/com/jme3/bullet/control/RigidBodyControl.html"><code>RigidBodyControl</code></a> (RBC)
instance is a rigid body, you can configure it and add it to a space
just like a directly instantiated rigid body.
For instance, you can configure friction using <code>setFriction()</code>
and disable contact response using <code>setContactResponse(false)</code>.</p>
</div>
<div class="paragraph">
<p>After being added to a <code>Spatial</code>,
the control synchronizes the motion of the rigid body
with that of the controlled spatial.</p>
</div>
<div class="paragraph">
<p>Disabling a rigid-body control
causes the body to be removed from the space it&#8217;s in, if any.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_constructors"><a class="anchor" href="#_constructors"></a>Constructors</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are 3 <a href="https://stephengold.github.io/Minie/javadoc/master/com/jme3/bullet/control/RigidBodyControl.html"><code>RigidBodyControl</code></a>
constructors:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">rbc1 = new RigidBodyControl(collisionShape, mass);
rbc2 = new RigidBodyControl(collisionShape);
rbc3 = new RigidBodyControl(mass);</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you specify <code>mass &gt; 0</code>, a dynamic body is created.
If you specify <code>mass = 0</code>, a static one is created.
If you construct an RBC without specifying a mass,
you get a dynamic body with <code>mass = 1</code>.</p>
</div>
<div class="paragraph">
<p>If you construct an RBC without specifying a collision shape,
you get an incomplete body.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Adding an incomplete body to a physics space will cause an crash!
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To complete the body,
simply add the control to a <code>Spatial</code> (<strong>before</strong> adding it to a space).
A collision shape will be created based on the controlled spatial, using:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>SphereCollisionShape</code> if the <code>Spatial</code> is a <code>Geometry</code> with spherical mesh,</p>
</li>
<li>
<p><code>BoxCollisionShape</code> if the <code>Spatial</code> is a <code>Geometry</code> with a box-shaped mesh,</p>
</li>
<li>
<p><code>CollisionShapeFactory.createDynamicMeshShape()</code> (for a dynamic body), or</p>
</li>
<li>
<p><code>CollisionShapeFactory.createMeshShape()</code> (for a static one).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="https://github.com/stephengold/Minie/blob/master/MinieExamples/src/main/java/jme3utilities/tutorial/HelloRbc.java">HelloRbc</a> is a simple
application that demonstrates the use of
<a href="https://stephengold.github.io/Minie/javadoc/master/com/jme3/bullet/control/RigidBodyControl.html"><code>RigidBodyControl</code></a>.
Things to notice while running the app:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The collision objects behave like directly instantiated rigid bodies.</p>
</li>
<li>
<p>Each geometry matches the motion of its corresponding physics object.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_kinematic_flags"><a class="anchor" href="#_kinematic_flags"></a>Kinematic flags</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To create a physics control for a <strong>kinematic</strong> rigid body,
first instantiate a dynamic RBC (with <code>mass &gt; 0</code>),
then convert it to kinematic using <code>rigidBodyControl.setKinematic(true)</code>.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/stephengold/Minie/blob/master/MinieExamples/src/main/java/jme3utilities/tutorial/HelloKinematicRbc.java">HelloKinematicRbc</a> is a simple
application that demonstrates a kinematic RBC.</p>
</div>
<div class="paragraph">
<p>By default, the physics object of a kinematic RBC
follows the motion of its controlled spatial.
To reposition it, you must reposition the <code>Spatial</code>.</p>
</div>
<div class="paragraph">
<p>To avoid this behavior, use <code>setKinematicSpatial(false)</code>.
The body will remain kinematic,
but it will no longer follow the motion of the controlled spatial.
The body can then be positioned directly,
using <code>setPhysicsLocation()</code> and <code>setPhysicsRotation()</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_synchronizing_scales"><a class="anchor" href="#_synchronizing_scales"></a>Synchronizing scales</h2>
<div class="sectionbody">
<div class="paragraph">
<p>While the <strong>motion</strong> of the controlled spatial matches
that of the body, their <strong>sizes</strong> might differ.
By default, there&#8217;s no connection between the scale of the controlled spatial
and the scale of the body&#8217;s collision shape.</p>
</div>
<div class="paragraph">
<p>To synchronize those scales, use <code>setApplyScale(true)</code>.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/stephengold/Minie/blob/master/MinieExamples/src/main/java/jme3utilities/tutorial/HelloApplyScale.java">HelloKinematicRbc</a> is a simple
application that demonstrates <code>setApplyScale()</code>.
Things to notice while running the app:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The rigid body is visualized as a blue wireframe.</p>
</li>
<li>
<p>The controlled geometry is shaded white.</p>
</li>
<li>
<p>The size of the rigid body matches that of the controlled geometry,
even as it pulsates.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_local_physics"><a class="anchor" href="#_local_physics"></a>Local physics</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default, a rigid-body control matches
the <strong>world</strong> transform of its controlled spatial.</p>
</div>
<div class="paragraph">
<p>To match the spatial&#8217;s <strong>local</strong> transform, use <code>setApplyPhysicsLocal(true)</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_summary"><a class="anchor" href="#_summary"></a>Summary</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>To associate a rigid body with a scene-graph spatial, use a
<a href="https://stephengold.github.io/Minie/javadoc/master/com/jme3/bullet/control/RigidBodyControl.html"><code>RigidBodyControl</code></a> (RBC).</p>
</li>
<li>
<p>If you construct an RBC without specifying a collision shape,
it will be incomplete until it gets added to a <code>Spatial</code>.</p>
</li>
<li>
<p>An RBC can be static, dynamic, or kinematic.</p>
</li>
<li>
<p>Generally, the motion of the controlled spatial matches that of the body,
but you can disable the matching behavior of a kinematic RBC.</p>
</li>
<li>
<p>To match the scales of the body and the controlled spatial,
use <code>setApplyScale(true)</code>.</p>
</li>
<li>
<p>To match the spatial&#8217;s local transform
instead of its world transform, use <code>setApplyPhysicsLocal(true)</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="shape.html">Collision shapes</a></span>
  <span class="next"><a href="debug.html">Debugging</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Page contents" data-levels="2">
  <div class="toc-menu" style="margin-top: 1rem;"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>Copyright 2020 Stephen Gold</p>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
